gx.controllers.module("attachments_modal",["modal",jse.core.config.get("shopUrl")+"/admin/html/assets/javascript/engine/libs/emails"],function(e){"use strict";var t=$(this),a=$("#emails-table"),s={},l=($.extend(!0,{},s,e),{}),n=function(e){""!==t.find("#removal-date").val()&&jse.libs.modal.message({title:jse.core.lang.translate("delete","buttons")+" - "+Date.parse(t.find("#removal-date").datepicker("getDate")).toString("dd.MM.yyyy"),content:jse.core.lang.translate("prompt_delete_old_attachments","emails"),buttons:[{text:jse.core.lang.translate("no","lightbox_buttons"),click:function(){$(this).dialog("close")}},{text:jse.core.lang.translate("yes","lightbox_buttons"),click:function(){jse.libs.emails.deleteOldAttachments($("#removal-date").datepicker("getDate")).done(function(e){var s=0!==e.size.megabytes?e.size.megabytes+" Megabytes":e.size.bytes+" Bytes";jse.libs.modal.message({title:"Info",content:jse.core.lang.translate("message_delete_old_attachments_success","emails")+"<br/>"+jse.core.lang.translate("count","admin_labels")+": "+e.count+", "+jse.core.lang.translate("size","db_backup")+": "+s}),jse.libs.emails.getAttachmentsSize($("#attachments-size")),a.DataTable().ajax.reload(),t.dialog("close")}).fail(function(e){jse.libs.modal.message({title:jse.core.lang.translate("error","messages"),content:e.message})}),$(this).dialog("close")}}]})};return l.init=function(e){t.on("click","#delete-old-attachments",n),e()},l});