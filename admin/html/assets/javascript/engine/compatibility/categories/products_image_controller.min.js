gx.compatibility.module("products_image_controller",["image_resizer"],function(e){"use strict";var i=$(this),n=window.gx.libs.image_resizer.resize,a={},t=function(){var a=i.find("input:file"),t=i.find("img.preview-image"),r=i.find("label.file-name"),m=i.find(".js-toggle-visibility"),d=i.find(".js-delete-checkbox");e.hasPrimaryImage||(m.hide(),t.hide()),a.on("change",function(a){var l=a.target.files[0],f=new FileReader;f.onload=function(e){t.show(),t.attr("src",e.target.result),n(t)},f.readAsDataURL(l),i.find('input[name*="gm_alt_text"]').val(""),m.is(":hidden")&&(m.fadeIn(),e.hasPrimaryImage||d.hide()),i.find('input[name="gm_prd_img_name"]').val(l.name),r.text(l.name)})},r=function(){var e=i.find("input:file"),a=i.find("img.preview-image"),t=i.find("label.file-name");e.on("change",function(e){var r=e.target.files[0],m=new FileReader;m.onload=function(e){a.attr("src",e.target.result),n(a)},m.readAsDataURL(r),i.find('input[name*="gm_alt_text"]').val(""),i.find('input[name="gm_prd_img_name"]').val(r.name),t.text(r.name)})},m=function(){i.is(".primary-image")?t():r()};return a.init=function(e){m(),e()},a});