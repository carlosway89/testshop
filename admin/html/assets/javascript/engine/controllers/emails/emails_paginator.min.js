gx.controllers.module("emails_paginator",[jse.core.config.get("shopUrl")+"/admin/html/assets/javascript/engine/libs/emails",jse.core.config.get("shopUrl")+"/admin/html/assets/javascript/engine/libs/button_dropdown","loading_spinner","modal"],function(e){"use strict";var t=$(this),a=$("#emails-table"),l=$("#attachments-size"),s={},n=($.extend(!0,{},s,e),{}),i=function(e){a.DataTable().ajax.reload(),jse.libs.emails.getAttachmentsSize(l)},o=function(e){var l=t.find("#display-records").val();a.DataTable().page.len(l).draw()},c=function(e){var t=$("#attachments-modal");t.find("#removal-date").val("").datepicker({maxDate:new Date}),$(document).find(".ui-datepicker").not(".gx-container").addClass("gx-container"),t.dialog({title:jse.core.lang.translate("handle_attachments","emails"),width:400,modal:!0,dialogClass:"gx-container",closeOnEscape:!1})},r=function(e){if(0!==a.find("tr td input:checked").length&&""!==$("#bulk-action").val()){var t=jse.libs.emails.getSelectedEmails(a);jse.libs.modal.message({title:jse.core.lang.translate("bulk_action","admin_labels"),content:jse.core.lang.translate("prompt_delete_collection","emails"),buttons:[{text:jse.core.lang.translate("no","lightbox_buttons"),click:function(){$(this).dialog("close")}},{text:jse.core.lang.translate("yes","lightbox_buttons"),click:function(){jse.libs.emails.deleteCollection(t).done(function(e){a.DataTable().ajax.reload(),jse.libs.emails.getAttachmentsSize(l)}).fail(function(e){jse.libs.modal.message({title:jse.core.lang.translate("error","messages"),content:e.message})}),$(this).dialog("close"),a.find("input[type=checkbox]").prop("checked",!1)}}]})}},d=function(e){if(0!==a.find("tr td input:checked").length&&""!==$("#bulk-action").val()){var t=jse.libs.emails.getSelectedEmails(a);jse.libs.modal.message({title:jse.core.lang.translate("bulk_action","admin_labels"),content:jse.core.lang.translate("prompt_send_collection","emails"),buttons:[{text:jse.core.lang.translate("no","lightbox_buttons"),click:function(){$(this).dialog("close")}},{text:jse.core.lang.translate("yes","lightbox_buttons"),click:function(){jse.libs.emails.sendCollection(t).done(function(e){a.DataTable().ajax.reload(),jse.libs.emails.getAttachmentsSize(l)}).fail(function(e){jse.libs.modal.message({title:jse.core.lang.translate("error","messages"),content:e.message})}),$(this).dialog("close"),a.find("input[type=checkbox]").prop("checked",!1)}}]})}};return n.init=function(e){t.on("click","#refresh-table",i).on("click","#handle-attachments",c).on("change","#display-records",o);var a=t.find(".bulk-action");jse.libs.button_dropdown.mapAction(a,"bulk_send_selected","emails",d),jse.libs.button_dropdown.mapAction(a,"bulk_delete_selected","emails",r),jse.libs.emails.getAttachmentsSize(l),e()},n});