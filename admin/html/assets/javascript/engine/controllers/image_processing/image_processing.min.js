gx.controllers.module("image_processing",[jse.core.config.get("shopUrl")+"/admin/html/assets/javascript/engine/libs/info_messages"],function(s){"use strict";var e=$(this),o={},a=!1,r=($.extend(!0,{},o,s),window.gx.libs.info_messages),i={},t=function(){$(".process-modal").dialog({title:jse.core.lang.translate("image_processing_title","image_processing"),modal:!0,dialogClass:"gx-container",buttons:[{text:jse.core.lang.translate("close","buttons"),"class":"btn",click:function(){$(this).dialog("close")}}],width:580}),n(1)},n=function(s){$.ajax({type:"POST",url:"admin.php?do=ImageProcessing/Process",timeout:3e4,dataType:"json",context:this,data:{image_number:s},success:function(e){var o=100/e.payload.imagesCount*s;o=Math.round(o),$(".process-modal .progress-bar").attr("aria-valuenow",o),$(".process-modal .progress-bar").css("min-width","70px"),$(".process-modal .progress-bar").css("width",o+"%"),$(".process-modal .progress-bar").html(s+" / "+e.payload.imagesCount),e.success||(a=!0),e.payload.finished?($(".process-modal").dialog("close"),$(".process-modal .progress-bar").attr("aria-valuenow",0),$(".process-modal .progress-bar").css("width","0%"),$(".process-modal .progress-bar").html(""),a?r.addError(jse.core.lang.translate("image_processing_error","image_processing")):r.addSuccess(jse.core.lang.translate("image_processing_success","image_processing")),a=!1):(s+=1,n(s))}})};return i.init=function(s){e.on("click",".js-process",t),s()},i});