gx.controllers.module("emails_toolbar",[jse.core.config.get("shopUrl")+"/admin/html/assets/javascript/engine/libs/emails","url_arguments"],function(e){"use strict";var t=$(this),n=$("#emails-modal"),i=$("#emails-table"),s={},l=($.extend(!0,{},s,e),{model:{settings:jse.core.config.get("shopUrl")+"/admin/admin.php?do=Emails/GetEmailSettings"}}),a=function(e){if(jse.libs.emails.resetModal(n),"undefined"!=typeof l.model.settings&&null!==l.model.settings){if(null!==l.model.settings.signature&&""!==l.model.settings.signature){var t="<br><p>-----<br>"+l.model.settings.signature+"</p>";CKEDITOR.instances["content-html"].setData(t);var s="\n\n-----\n"+l.model.settings.signature.replace(/(<([^>]+)>)/gi,"");n.find("#content-plain").val(s)}l.model.settings.useHtml===!1&&(n.find(".content").find(".tab-headline:eq(0), .tab-content:eq(0)").hide(),n.find(".content").find(".tab-headline:eq(1)").trigger("click")),"undefined"!=typeof l.model.settings.replyAddress&&""!==l.model.settings.replyAddress&&n.find("#sender-email, #reply-to-email").val(l.model.settings.replyAddress),"undefined"!=typeof l.model.settings.replyName&&""!==l.model.settings.replyName&&n.find("#sender-name, #reply-to-name").val(l.model.settings.replyName)}n.dialog({title:jse.core.lang.translate("new_mail","buttons"),width:1e3,height:740,modal:!1,dialogClass:"gx-container",closeOnEscape:!1,buttons:jse.libs.emails.getDefaultModalButtons(n,i),open:jse.libs.emails.colorizeButtonsForEditMode})},o=function(e){e.preventDefault();var n=t.find("#search-keyword").val();i.DataTable().search(n).draw()};return l.init=function(e){t.find("#bulk-action").val(""),t.on("click","#create-new-email",a).on("submit","#quick-search",o);var i=jse.libs.url_arguments.getParameterArray();"undefined"!=typeof i.mailto&&(a({}),n.find("#recipient-email").val(i.mailto)),e()},l});