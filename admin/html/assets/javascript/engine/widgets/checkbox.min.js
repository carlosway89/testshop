gx.widgets.module("checkbox",[],function(e){"use strict";var s=$(this),t={filter:"",on_url:"",off_url:"",on_label:"",off_label:"",on_text:"",off_text:"","class":"",checked:!1},a=!1,c=$.extend(!0,{},t,e),i={},n=function(e){if($(this).hasClass("disabled"))return!1;var s=$(this),t=s.find("input:checkbox"),a=s.find("input:radio").first(),i=s.find("input:radio").last(),n=s.find("select").first();s.parent().data("checkbox");s.toggleClass("checked"),s.find(".state-description").show().fadeOut("slow"),t.prop("checked",s.hasClass("checked")),a.prop("checked",s.hasClass("checked")),i.prop("checked",!s.hasClass("checked")),n.find("option").removeAttr("selected");var o=s.hasClass("checked")?1:0;if(n.find('option[value="'+o+'"]').attr("selected",!0),""!==c.on_url&&""!==c.off_url){if(e.preventDefault(),e.stopPropagation(),c.checked)return window.location.href=c.off_url,c.checked=!1,!1;window.location.href=c.on_url,c.checked=!0}},o=function(){return $(this).hasClass("disabled")?!1:(a=!0,void $(this).find("input:checkbox").focus())},d=function(){return $(this).hasClass("disabled")?!1:($(this).toggleClass("checked"),$(this).find("input:checkbox").focus(),$(this).find("input:checkbox").trigger("click"),void(a=!1))},l=function(e){var t=e||s;t.find("input:checkbox").filter(c.filter||"*").each(function(){var e=$(this),s=i._data(e),t=s.className||"",n=e.prop("title"),o=e.prop("checked")?"checked":"",d=e.prop("disabled")?"disabled":"";if("undefined"!=typeof e.data("single_checkbox"))e.css({position:"absolute",left:"-100000px"}).wrap('<span class="single-checkbox '+o+" "+d+'" title="'+n+'"></span>').parent().append('<i class="fa fa-check"></i>'),e.on("focus",function(){$(".single_checkbox").removeClass("focused"),$(this).parent().addClass("focused")}),e.on("blur",function(){$(this).parent().removeClass("focused")}),e.on("change",function(){a===!1&&$(this).parent().toggleClass("checked")});else{var l=e.attr("data-checkbox-on_text")?e.attr("data-checkbox-on_text"):'<span class="fa fa-check"></span>',f=e.attr("data-checkbox-on_text")?e.attr("data-checkbox-off_text"):'<span class="fa fa-times"></span>';e.wrap('<div class="switcher '+o+" "+d+'" title="'+n+'"></div>').parent().data("checkbox",s).addClass(t).append('<div class="switcher-toggler"></div><div class="switcher-inner"><div class="switcher-state-on">'+l+'</div><div class="switcher-state-off">'+f+'</div></div><div class="switcher-text-on">'+c.on_text+'</div><div class="switcher-text-off">'+c.off_text+"</div>")}})},f=function(){if(2===s.find("input:radio").filter(c.filter||"*").length){var e=s.find("input:radio").filter(c.filter||"*").first(),t=e.prop("title"),a=s.find("input:radio").filter(c.filter||"*").last(),i=a.prop("title"),n=""!==c.on_label?' data-checkbox-label="'+c.on_label+'"':"",o=""!==c.off_label?' data-checkbox-label="'+c.off_label+'"':"",d=c,l=e.prop("checked")?"checked":"",f=e.prop("disabled")?"disabled":"",r=$('<div class="switcher '+l+" "+f+'"></div>');e.after(r),e.appendTo(r),a.appendTo(r),r.data("checkbox",d).addClass(c["class"]).append('<div class="switcher-toggler"></div><div class="switcher-inner"><div class="switcher-state-on" title="'+t+'"'+n+'><span class="fa fa-check"></span></div><div class="switcher-state-off" title="'+i+'"'+o+'><span class="fa fa-times"></span></div><div class="switcher-text-on">'+c.on_text+'</div><div class="switcher-text-off">'+c.off_text+"</div></div>"),e.on("change",function(){$(this).parent().toggleClass("checked")}),a.on("change",function(){$(this).parent().toggleClass("checked")})}},r=function(){if(""!==c.on_url&&""!==c.off_url){var e=i._data(s),t=""!==c.on_label?' data-checkbox-label="'+c.on_label+'"':"",a=""!==c.off_label?' data-checkbox-label="'+c.off_label+'"':"",o=c.checked?"checked":"";s.data("checkbox",e).addClass("switcher").addClass(o).addClass(c["class"]).append('<div class="switcher-toggler"></div><div class="switcher-inner"><div class="switcher-state-on" title="'+c.off_url+'"'+t+'><span class="fa fa-check"></span></div><div class="switcher-state-off" title="'+c.on_url+'"'+a+'><span class="fa fa-times"></span></div></div>').on("click",n)}},h=function(){s.on("click",".switcher",n),s.off("mousedown",".single-checkbox"),s.on("mousedown",".single-checkbox",o),s.off("mouseup",".single-checkbox"),s.on("mouseup",".single-checkbox",d),s.on("mousedown","label",function(){a=!0}),s.on("mouseup","label",function(){a=!1}),s.on("FORM_UPDATE",function(e){var s=$(e.target);s.find("input:checkbox").each(function(){var e=$(this),s=e.closest(".switcher");s.length&&(s.find("div").remove(),e.unwrap())}),l(s)})},p=function(){s.find("[data-convert-checkbox]").each(function(e,s){var t=$(s).find('option[value="1"]'),a=($(s).find('option[value="0"]'),t.is(":selected")?"checked":""),i=$(s).is(":disabled")?"disabled":"",n=$('<div class="switcher '+a+" "+i+'"></div>');n.addClass($(s).data("newClass")).data("checkbox",c).append('<div class="switcher-toggler"></div><div class="switcher-inner"><div class="switcher-state-on"><span class="fa fa-check"></span></div><div class="switcher-state-off"><span class="fa fa-times"></span></div></div>'),$(s).after(n).appendTo(n).hide()})};return i.init=function(e){l(),f(),p(),r(),h(),e()},i});