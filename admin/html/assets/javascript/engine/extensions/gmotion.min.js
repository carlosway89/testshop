gx.extensions.module("gmotion",[],function(n){"use strict";var o={},i=$(this),t=$("input#gm_gmotion_activate"),e=i.find(".gmotion-setting"),a=i.find(".gm_gmotion_image:first"),r=i.find(".js-gmotion-panel:first"),s=i.find(".gm_gmotion_start:first"),m=i.find(".gm_gmotion_end:first"),c=i.find(".js-gmotion-image:first"),d=r.find('[name^="gm_gmotion_position_from_"]'),f=r.find('[name^="gm_gmotion_position_to_"]'),l=r.find('[name^="gm_gmotion_zoom_from_"]'),u=r.find('[name^="gm_gmotion_zoom_to_"]'),g=r.find('[name^="gm_gmotion_duration_"]'),_=(r.find('[name^="gm_gmotion_sort_order_"]'),0),p=50,h=100,v=50,k=1,z=1,T=10,x=12,y=14,C=function(n,o,i){var t=s.is(n)?d:f,e=[o+"%",i+"%"].join(" ");t.val(e)},F=function(n){var o=q($(n).val()),i=null===o||o[0]>100||o[1]>100;if(!i){var t=M(o[0],o[1]),e=d.is(n)?s:m;j(e,t)}},b=function(){var n={containment:c,drag:function(){var n=w($(this).css("left").replace("px",""),$(this).css("top").replace("px",""));C(this,n.left,n.top)}};s.draggable(n),m.draggable(n)},j=function(n,o){$(n).css(o)},w=function(n,o){var i={left:null,top:null},t=c.width()-x,e=n/t*100;i.left=Math.round(e);var a=c.height()-y,r=o/a*100;return i.top=Math.round(r),i},M=function(n,o){var i={left:null,top:null},t=c.width()-x;i.left=t/100*n;var e=c.height()-y;return i.top=e/100*o,i},q=function(n){var o,i=/([\d]+)/g,t=n.match(i);return o=null===t||t.length<2?null:[t[0],t[1]]},A=function(n){n?e.not(r).removeClass("hidden"):e.addClass("hidden")},B=function(n){n?(r.removeClass("hidden").css({opacity:.1}),setTimeout(function(){b(),E(),r.animate({opacity:1})},1e3)):r.addClass("hidden"),r.find("input, select").prop("disabled",!n)},D=function(){t.parent().on("click",function(){A(t.is(":checked")),B(a.is(":checked")&&t.is(":checked"))}),a.parent().on("click",function(){B(a.is(":checked"))}),d.on("keyup",function(){F(this)}),f.on("keyup",function(){F(this)})},E=function(){n.positionFrom?d.val(n.positionFrom):C(d,_,p),F(d),n.positionTo?f.val(n.positionTo):C(f,h,v),F(f);var o=n.zoomFrom?n.zoomFrom:k;l.val(o);var i=n.zoomTo?n.zoomTo:z;u.val(i);var t=n.duration?n.duration:T;g.val(t)};return o.init=function(n){D(),t.is(":checked")&&(A(!0),a.is(":checked")&&B(!0)),n()},o});